#include "mlp.h"
#include "mlp_weights.h"

int main() {
    MLP mlp = {
        .coefs = {coefs_0, coefs_1, coefs_2, coefs_3},
        .intercepts = {intercepts_0, intercepts_1, intercepts_2, intercepts_3},
        .sizes = {49, 28, 16, 24, 1}
    };

    double input_data[INPUT_SIZE] = {
		-0.61327914, -0.99918572, -0.98286742, -0.31471025, -1.59591856, -0.93534796,
		-0.74255503, -1.03311778,  0.30620064, -0.31743973, -1.28728620, -0.80379660,
		-1.13145042,  1.17526967, -0.63994083, -1.40036193, -1.28646795,  0.40628711,
		-1.78593733,  1.64605734, -0.07415700, -0.19865641,  0.13969543, -0.29757337,
		-1.89840715,  0.79718179, -0.69080763, -0.79603785,  1.59140680, -0.37860750,
		-0.39206718,  0.38250161, -1.27119709, -1.61075342, -0.90162425,  1.29302751,
		 1.29650466,  0.16307318,  0.47436850,  0.51141233, -1.22901988, -1.41219012,
		-1.50943419, -1.01230131, -1.00698745, -1.03135063, -0.52034247,  1.07980184,
		 0.14025622
	};

    double result = inference_mlp(&mlp, input_data);
    printf("Safe proba by MLP: %.8f\n", result);

    return 0;
}